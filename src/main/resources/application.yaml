server:
  port: 8090

spring:
  application:
    name: api-gateway

  data:
    redis:
      host: localhost
      port: 6379
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  cloud:
    gateway:
      routes:
        # public endpoints
        - id: public-endpoints
          uri: http://localhost:8081
          predicates:
            - Path=api/public/**
          filter:
            - StripPrefix=2

        # protected endpoints
        - id: user-service
          uri: http://localhost:8081
          predicates:
            - Path=/api/user/**
          filters:
            - AuthenticationFilter
            - name: RateLimitingFilter
              args:
                keyStrategy: USER    # Per user
                capacity: 2         # 50 requests max
                refillTokens: 50     # Add 50 tokens
                refillDuration: 60   # Every 60 seconds
            - LoggingFilter

jwt:
  # JWKS endpoint from authorization server
  jwks-uri: http://localhost:9000/oauth2/jwks

  # Issuer URL from your authorization server
  issuer: http://localhost:9000

rate-limit:
  enabled: true
  default-capacity: 100
  default-refill-tokens: 100
  default-refill-duration: 60

logging:
  level:
    com.example.gateway: DEBUG
    org.springframework.cloud.gateway: DEBUG  # ‚Üê Set to TRACE temporarily
    org.springframework.web.server: DEBUG
